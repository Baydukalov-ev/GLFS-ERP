#Область ОбработчикиСобытий

Процедура ПередЗаписью(Отказ) 
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;

	Если Не НаименованиеУникально() Тогда
		ОбщегоНазначения.СообщитьПользователю(НСтр("ru='Наименование не уникально'"),,,, Отказ);
	КонецЕсли;

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция НаименованиеУникально()
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	бг_ВариативностьНоменклатуры.Ссылка КАК Ссылка
		|ИЗ
		|	Справочник.бг_ВариативностьНоменклатуры КАК бг_ВариативностьНоменклатуры
		|ГДЕ
		|	бг_ВариативностьНоменклатуры.Наименование = &Наименование
		|	И бг_ВариативностьНоменклатуры.Ссылка <> &Ссылка";
	
	Запрос.УстановитьПараметр("Наименование", Наименование);
	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	
	РезультатЗапроса = Запрос.Выполнить();
	Возврат РезультатЗапроса.Пустой();
	
КонецФункции  

#КонецОбласти
